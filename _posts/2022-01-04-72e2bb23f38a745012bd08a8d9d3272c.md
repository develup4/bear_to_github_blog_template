---
title:  ğŸƒSpring Filterì™€ Interceptor

categories: ìŠ¤í”„ë§ë¶€íŠ¸ 
tags: backend  java  filter  interceptor
 
---

  
## Filter  
- ìŠ¤í”„ë§ì˜ AOPì²˜ëŸ¼ ì„œë¸”ë¦¿ì˜ ê³µí†µ ê´€ì‹¬ì‚¬ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ ë‹´ë‹¹í•˜ëŠ” ìš”ì†Œê°€ Filterì´ë‹¤.  
  
### Filterì˜ íë¦„(Filter Chain)  
  
```  
HTTP REQUEST -> WAS -> FILTER1 â€”> FILTER2 -> â€¦ -> SERVLET -> CONTROLLER  
```  
  
### Filter êµ¬í˜„  
  
```java  
public class LogFilter implements Filter {  
  
	@Override  
	public void init(FilterConfig filterConfig) throws ServletException {  
		log.info("log filter init");  
	}  
  
	@Override  
	public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {  
		HttpServletRequest httpRequest = (HttpServletRequest)request;  
		String requestUri = httpRequest.getRequestURI();  
		String uuid = UUID.randomUUID().toString();  
  
		try {  
			log.info("REQUEST {} {} ", uuid, requestUri);  
  
			// ë§¤ìš° ì¤‘ìš”! ì´ ì½”ë“œê°€ ìˆì–´ì•¼ ë‹¤ìŒ ì²´ì¸ìœ¼ë¡œ ë„˜ì–´ê°„ë‹¤.  
			chain.doFilter(request, response);	  
		} catch(Exception e) {  
			throw e;  
		} finally {  
			log.info("RESPONSE {} {}", uuid, requestUri);  
		}  
	}  
  
	@Override  
	public default void destroy() {  
		log.info("log filter destroy");  
	}  
}  
```  
  
### Filterì˜ ë“±ë¡  
- Configurationì—ì„œ `FilterRegistrationBean`ì„ ì´ìš©í•˜ì—¬ ë“±ë¡í•œë‹¤.  
- ìš°ì„ ìˆœìœ„, ì ìš©í•  url íŒ¨í„´ ë“±ì„ ë“±ë¡í•  ìˆ˜ ìˆë‹¤.  
  
```java  
@Configuration  
public class WebConfig {  
  
	@Bean  
	public FilterRegistrationBean logFilter() {  
		FilterRegistrationBean<Filter> filterRegistrationBean = new FilterRegistrationBean<>();  
  
		filterRegistrationBean.setFilter(new LogFilter());  
		filterRegistrationBean.setOrder(1);  
		filterRegistrationBean.addUrlPattern("/login");  
		return filterRegistrationBean;  
	}  
}  
```  
  
## Interceptor  
- FilterëŠ” ì„œë¸”ë¦¿ì´ ì œê³µí•˜ëŠ” ê¸°ìˆ ì´ë©°, InterceptorëŠ” ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê¸°ìˆ ì´ë‹¤. ë” ë›°ì–´ë‚œ ë¶€ë¶„ì´ ë§ë‹¤.  
  
### Interceptorì˜ íë¦„  
- ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´ë¯€ë¡œ Dispatcher servlet ì´í›„ì— ì ìš©ëœë‹¤.  
  
```  
HTTP REQUEST -> WAS -> FILTER1 â€”> FILTER2 -> â€¦ -> SERVLET -> INTERCEPTOR1 -> INTERCEPTOR2 -> â€¦ -> CONTROLLER  
```  
  
### Interceptor êµ¬í˜„  
  
```java  
public class LogInterceptor implements HandlerInterceptor {  
  
	@Override  
	public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {  
		// ì¸í„°ì…‰í„°ê°€ ì²˜ë¦¬í•˜ëŠ” ë¶€ë¶„  
		return true;	// falseë¥¼ ë¦¬í„´í•˜ë©´ ë” ì´ìƒ ì§„í–‰í•˜ì§€ ì•ŠëŠ”ë‹¤.  
	}  
  
	@Override  
	public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {  
		// ì˜ˆì™¸ ë°œìƒì‹œ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤.  
	}  
  
	@Override  
	public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {  
		// ì˜ˆì™¸ê°€ ë°œìƒí•´ë„ í˜¸ì¶œëœë‹¤.  
	}  
}  
```  
  
### Interceptor ë“±ë¡  
  
```java  
@Configuration  
public class WebConfig implements WebMvcConfigurer {  
  
	@Override  
	public void addInterceptors(InterceptorRegistry registry) {  
		registry.addInterceptor(new LogInterceptor())  
			.order(1)  
			.addPathPatterns("/login")  
			.excludePathPatterns("/css");  
	}  
}  
```  
